

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Phonon energies &mdash; My_BigDFT  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Infrared spectrum" href="infrared.html" />
    <link rel="prev" title="Phonon energies, infrared and Raman spectra" href="phonons_infrared_raman.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> My_BigDFT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="code_doc.html">Code Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="iofiles.html">Input and Output files</a></li>
<li class="toctree-l2"><a class="reference internal" href="job.html">Job</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="workflows.html">Workflows</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="workflow.html">AbstractWorkflow and Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="convergences.html">Convergence classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="poltensors.html">Electronic and vibrational polarizability tensors</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="phonons_infrared_raman.html">Phonon energies, infrared and Raman spectra</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Phonon energies</a></li>
<li class="toctree-l4"><a class="reference internal" href="infrared.html">Infrared spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="raman.html">Raman spectrum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="geopt.html">Geometry optimization (Geopt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="dissociation.html">Dissociation curve</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">MyBigDFT tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercises.html">Exercises</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">My_BigDFT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="code_doc.html">Code Documentation</a> &raquo;</li>
        
          <li><a href="workflows.html">Workflows</a> &raquo;</li>
        
          <li><a href="phonons_infrared_raman.html">Phonon energies, infrared and Raman spectra</a> &raquo;</li>
        
      <li>Phonon energies</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/phonons.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-mybigdft.workflows.phonons">
<span id="phonon-energies"></span><h1>Phonon energies<a class="headerlink" href="#module-mybigdft.workflows.phonons" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#mybigdft.workflows.phonons.Phonons" title="mybigdft.workflows.phonons.Phonons"><code class="xref py py-class docutils literal notranslate"><span class="pre">Phonons</span></code></a> class allows to compute the normal modes of a
system.</p>
<dl class="class">
<dt id="mybigdft.workflows.phonons.Phonons">
<em class="property">class </em><code class="sig-prename descclassname">mybigdft.workflows.phonons.</code><code class="sig-name descname">Phonons</code><span class="sig-paren">(</span><em class="sig-param">ground_state</em>, <em class="sig-param">translation_amplitudes=None</em>, <em class="sig-param">order=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mybigdft/workflows/phonons.html#Phonons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="workflow.html#mybigdft.workflows.workflow.AbstractWorkflow" title="mybigdft.workflows.workflow.AbstractWorkflow"><code class="xref py py-class docutils literal notranslate"><span class="pre">mybigdft.workflows.workflow.AbstractWorkflow</span></code></a></p>
<p>This class allows to run all the calculations enabling the
computation of the phonon energies of a given system.</p>
<p>To get the phonon energies of the system, one needs to find the
eigenvalues of the dynamical matrix, that is closely related to the
Hessian. To build these matrices, one must find the derivatives of
the forces when each coordinate of each atom is translated by a
small amount around the equilibrium positions. This derivative must
be performed numerically. For a first order evaluation of the
derivative, <span class="math notranslate nohighlight">\(3 n_{at} + 1\)</span> DFT calculations must be performed,
where <span class="math notranslate nohighlight">\(n_{at}\)</span> is the number of atoms of the system, the 3
factors comes from the translations along each space coordinate,
while the extra calculation corresponds to the ground state.
However, this might not be precise enough because you want the
ground state forces to be equal to 0, or at least negligible with
respect to the forces of the out of equilibrium positions. This can
be difficult to obtain. It is therefore advised to evaluate that
derivative with a second order scheme, where each coodinate is
translated positively and negatively, so that the number of BigDFT
calculations amounts to <span class="math notranslate nohighlight">\(2*3*n_{at} = 6 n_{at}\)</span> (no
<span class="math notranslate nohighlight">\(+ 1\)</span> here, because there is no need to compute the ground
state anymore).</p>
<p>From a ground state calculation, which must correspond to the
equilibrium calculation geometry, the <span class="math notranslate nohighlight">\(3 n_{at}+1\)</span> or
<span class="math notranslate nohighlight">\(6 n_{at}\)</span> jobs necessary for the calculation of the
phonon energies are prepared (depending on the order of the
calculation).</p>
<p>The distance of the displacement in each direction is controlled
by <cite>translation_amplitudes</cite> (one amplitude per space coordinate
must be given).</p>
<p>The phonon energies calculations are computed while post-
processing the results of all the calculations (after running
the run method). They correspond to the energies of the Raman
spectrum. If interested in getting the Raman intensity and
depolarization ratio of each phonon (or normal mode), see
<a class="reference internal" href="raman.html#mybigdft.workflows.ramanspectrum.RamanSpectrum" title="mybigdft.workflows.ramanspectrum.RamanSpectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">RamanSpectrum</span></code></a>. If
interested in getting the infrared intensity of each phonon, see
<code class="xref py py-class docutils literal notranslate"><span class="pre">InfraredSpectrum</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ground_state</strong> (<a class="reference internal" href="job.html#mybigdft.job.Job" title="mybigdft.job.Job"><em>Job</em></a>) – Job of the ground state of the system under consideration.</p></li>
<li><p><strong>translation_amplitudes</strong> (<em>Sequence of length 3</em>) – Amplitudes of the translations to be applied to each atom
along each of the three space coordinates (in atomic units).</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Order of the numerical differentiation used to compute the
dynamical matrix. If second order (resp. first), then six
(resp. three) calculations per atom are to be performed.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.ground_state">
<em class="property">property </em><code class="sig-name descname">ground_state</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.ground_state" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Job of the ground state of the system under consideration.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="job.html#mybigdft.job.Job" title="mybigdft.job.Job">Job</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.translation_amplitudes">
<em class="property">property </em><code class="sig-name descname">translation_amplitudes</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.translation_amplitudes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Amplitudes of the translations to be applied to each atom
along each of the three space coordinates.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Sequence of length 3</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.order">
<em class="property">property </em><code class="sig-name descname">order</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.order" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>order</strong> – Order of the numerical differentiation used to compute the
dynamical matrix. If second order (resp. first), then six
(resp. three) calculations per atom are to be performed.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.energies">
<em class="property">property </em><code class="sig-name descname">energies</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.energies" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Phonon energies of the system (units: cm^-1).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.array or None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.dyn_mat">
<em class="property">property </em><code class="sig-name descname">dyn_mat</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.dyn_mat" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dynamical matrix deduced from the calculations.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.array or None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.normal_modes">
<em class="property">property </em><code class="sig-name descname">normal_modes</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.normal_modes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Normal modes of the system found as eigenvectors of the
dynamical matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.array or None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.displacements">
<em class="property">property </em><code class="sig-name descname">displacements</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.displacements" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Displacements each atom of the system must undergo before
computing the dynamical matrix as post-processing. There are
three or six of them (one or two per space coordinate,
depending on the order of the numerical derivative
procedure) if the forward or central difference scheme is
used, respectively.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>OrderedDict of length 3 or 6</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.post_proc">
<code class="sig-name descname">post_proc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mybigdft/workflows/phonons.html#Phonons.post_proc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.post_proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the post-processing of the calculations, here:</p>
<ul class="simple">
<li><p>compute the dynamical matrix,</p></li>
<li><p>solve it to get the phonons (normal modes) and their energies.</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.is_completed">
<em class="property">property </em><code class="sig-name descname">is_completed</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.is_completed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>True</cite> if all the post-processing attributes are no longer
set to their default value.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.logfiles">
<em class="property">property </em><code class="sig-name descname">logfiles</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.logfiles" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary of all the logfiles of the workflow, with the
name of the associated job as key.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.queue">
<em class="property">property </em><code class="sig-name descname">queue</code><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.queue" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All the jobs of the workflow.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Phonons.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">nmpi=1</em>, <em class="sig-param">nomp=1</em>, <em class="sig-param">force_run=False</em>, <em class="sig-param">dry_run=False</em>, <em class="sig-param">restart_if_incomplete=False</em>, <em class="sig-param">timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mybigdft.workflows.phonons.Phonons.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run all the calculations if the post-processing was not already
performed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <cite>force_run</cite> or <cite>dry_run</cite> is set to <cite>True</cite>, then any
previous value of the post-processing attributes is deleted
and set back to their default value, so that the
post-processing is not considered as being performed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmpi</strong> (<em>int</em>) – Number of MPI tasks.</p></li>
<li><p><strong>nomp</strong> (<em>int</em>) – Number of OpenMP tasks.</p></li>
<li><p><strong>force_run</strong> (<em>bool</em>) – If <cite>True</cite>, the calculations are run even though a logfile
already exists.</p></li>
<li><p><strong>dry_run</strong> (<em>bool</em>) – If <cite>True</cite>, the input files are written on disk, but the
bigdft-tool command is run instead of the bigdft one.</p></li>
<li><p><strong>restart_if_incomplete</strong> (<em>bool</em>) – If <cite>True</cite>, the job is restarted if the existing logfile is
incomplete.</p></li>
<li><p><strong>timeout</strong> (<em>float</em><em> or </em><em>int</em><em> or </em><em>None</em>) – Number of minutes after which each job must be stopped.</p></li>
</ul>
</dd>
<dt class="field-even">Warns</dt>
<dd class="field-even"><p><strong>UserWarning</strong> – If the post-processing was already completed.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mybigdft.workflows.phonons.Displacement">
<em class="property">class </em><code class="sig-prename descclassname">mybigdft.workflows.phonons.</code><code class="sig-name descname">Displacement</code><a class="reference internal" href="_modules/mybigdft/workflows/phonons.html#Displacement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mybigdft.workflows.phonons.Displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mybigdft.workflows.phonons.Displacement" title="mybigdft.workflows.phonons.Displacement"><code class="xref py py-class docutils literal notranslate"><span class="pre">mybigdft.workflows.phonons.Displacement</span></code></a></p>
<p>This class defines an atomic displacement from the coordinate index
and the amplitude of the displacement in that direction.</p>
<p>Create new instance of Displacement(i_coord, amplitude)</p>
<dl class="method">
<dt id="mybigdft.workflows.phonons.Displacement.vector">
<em class="property">property </em><code class="sig-name descname">vector</code><a class="headerlink" href="#mybigdft.workflows.phonons.Displacement.vector" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Displacement vector.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Displacement.amplitude">
<em class="property">property </em><code class="sig-name descname">amplitude</code><a class="headerlink" href="#mybigdft.workflows.phonons.Displacement.amplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Displacement.count">
<code class="sig-name descname">count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mybigdft.workflows.phonons.Displacement.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of occurrences of value.</p>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Displacement.i_coord">
<em class="property">property </em><code class="sig-name descname">i_coord</code><a class="headerlink" href="#mybigdft.workflows.phonons.Displacement.i_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="mybigdft.workflows.phonons.Displacement.index">
<code class="sig-name descname">index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mybigdft.workflows.phonons.Displacement.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="infrared.html" class="btn btn-neutral float-right" title="Infrared spectrum" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="phonons_infrared_raman.html" class="btn btn-neutral float-left" title="Phonon energies, infrared and Raman spectra" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, mmoriniere, OMalenfantThuot

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>